(()=>{"use strict";var e={19:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n{}class s{constructor(e,t){this.field=e,this.action=t}is(e){return this.action.where((t=>t[this.field]==e))}isnt(e){return this.action.where((t=>t[this.field]!=e))}greaterThan(e){return this.action.where((t=>t[this.field]>e))}lesserThan(e){return this.action.where((t=>t[this.field]<e))}greaterThanOrEqualTo(e){return this.action.where((t=>t[this.field]>=e))}lesserThanOrEqualTo(e){return this.action.where((t=>t[this.field]<=e))}isTrue(){return this.action.where((e=>e[this.field]))}isFalse(){return this.action.where((e=>e[this.field]))}has(e){return this.action.where((t=>t[this.field].includes(e)))}length(){return new r(this)}}class r extends s{constructor(e){super(e.field,e.action)}is(e){return this.action.where((t=>t[this.field].length==e))}isnt(e){return this.action.where((t=>t[this.field].length!=e))}greaterThan(e){return this.action.where((t=>t[this.field].length>e))}lesserThan(e){return this.action.where((t=>t[this.field].length<e))}greaterThanOrEqualTo(e){return this.action.where((t=>t[this.field].length>=e))}lesserThanOrEqualTo(e){return this.action.where((t=>t[this.field].length<=e))}isTrue(){throw Error("You can't evaluate length as a boolean")}isFalse(){throw Error("You can't evaluate length as a boolean")}has(e){throw Error("You can't evaluate length as an array")}length(){throw Error("You can't take the length of a length")}}class i{constructor(e){this.document=e}where(e){return"string"==typeof e?new s(e,this):new Promise(((t,n)=>{chrome.storage.sync.get(this.document,(s=>{if(null!=s[this.document]){var r=[];for(var i of s[this.document])e(i)&&r.push(i);t(r)}n(`Error finding document ${this.document}`)}))}))}all(){return new Promise(((e,t)=>{chrome.storage.sync.get(this.document,(n=>{null!=n[this.document]&&e(n[this.document]),t(`Error finding document ${this.document}`)}))}))}}class o{constructor(e,t){this.document=e,this.values=t}where(e){return"string"==typeof e?new s(e,this):new Promise(((t,n)=>{chrome.storage.sync.get(this.document,(s=>{if(null!=s[this.document]){for(var r=0;r<s[this.document].length;r++)e(s[this.document][r])&&this.values.forEach(((e,t)=>{s[this.document][r][t]=e}));chrome.storage.sync.set({[this.document]:s[this.document]},(()=>{t(!0)}))}n(`Error finding document ${this.document}`)}))}))}all(){return new Promise(((e,t)=>{chrome.storage.sync.get(this.document,(n=>{if(null!=n[this.document]){for(var s=0;s<n[this.document].length;s++)this.values.forEach(((e,t)=>{n[this.document][s][t]=e}));chrome.storage.sync.set({[this.document]:n[this.document]},(()=>{e(!0)}))}t(`Error finding document ${this.document}`)}))}))}}class h{constructor(e){this.name=e}get(){return new i(this.name)}set(e){return new o(this.name,e)}add(e){return new Promise(((t,n)=>{chrome.storage.sync.get(this.name,(s=>{null!=s[this.name]?(s[this.name].push(e),chrome.storage.sync.set({[this.name]:s[this.name]},(()=>{t(!0)}))):n(`Error finding document ${this.name}`)}))}))}addAll(e){return new Promise(((t,n)=>{chrome.storage.sync.get(this.name,(s=>{null!=s[this.name]?(s.addAll(e),chrome.storage.sync.set({[this.name]:s},(()=>{t(!0)}))):n(`Error finding document ${this.name}`)}))}))}}class c{static init(e){var t=new c;return t.database=e,new Promise(((s,r)=>{chrome.storage.sync.get("chromedb_config",(r=>{t.config=new n,null!=r.chromedb_config?(t.config.documents=r.chromedb_config,e in t.config.documents||(t.config.documents[e]=[])):t.config.documents[e]=[],s(t)}))}))}doc(e){if(this.config.documents[this.database].includes(e))return new h(e);throw Error(`Document ${e} doesn't belong to database ${this.database}`)}makeDoc(e){return this.config.documents[this.database].includes(e)?new Promise(((e,t)=>{e(!1)})):new Promise(((t,n)=>{chrome.storage.sync.set({[e]:[]},(()=>{this.config.documents[this.database].push(e),console.log(`Added document: ${this.config.documents[this.database]}`),t(!0)}))}))}deleteDoc(e){return new Promise(((t,n)=>{chrome.storage.sync.remove(e,(()=>{this.config.documents[this.database].splice(this.config.documents[this.database].indexOf(e),1),t(!0)}))}))}}t.ChromeDB=c},367:function(e,t,n){var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(r,i){function o(e){try{c(s.next(e))}catch(e){i(e)}}function h(e){try{c(s.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(o,h)}c((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(19);(()=>{s(this,void 0,void 0,(function*(){let e=yield r.ChromeDB.init("myDB");yield e.makeDoc("MyDoc"),yield e.doc("MyDoc").add({id:0,content:"hello"});var t=yield e.doc("MyDoc").get().where("id").is(1);console.log(t)}))})()}},t={};!function n(s){if(t[s])return t[s].exports;var r=t[s]={exports:{}};return e[s].call(r.exports,r,r.exports,n),r.exports}(367)})();